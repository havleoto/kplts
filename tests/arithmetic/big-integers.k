;;;
;;; arithmetic/big-integers.k
;;;
;;; Test arithmetic operations with big (10^3-10^100) integer arguments.
;;;
($test-group +
    ((cite (kernel-report 12 5 4)
           "Applicative + returns the sum of the elements of /numbers/.")
     (require-standard-bindings +)
     (number 10))
  ($eval-table
    ((+ 0 7919759840279321592) 7919759840279321592)
    ((+ 187550 4102336) 4289886)
    ((+ 2536515429 11286751297507692996443931898106488671864136110) 11286751297507692996443931898106488674400651539)
    ((+ 2780470347562435811679 29906301470746528504950530694338661014221923525802) 29906301470746528504950530697119131361784359337481)
    ((+ 33492202702198545162126796 15208315294850514387773228927148876) 15208315328342717089971774089275672)
    ((+ -370373780605249836 17609440394749229253769935044810521768176) 17609440394749229253769564671029916518340)
    ((+ 4407725824552133593412542665015830763211667808 37768171609399010431897182) 4407725824552133593450310836625229773643564990)
    ((+ 5641870629014188699627660489496259600 12344286753178458568365730260) 5641870641358475452806119057861989860)
    ((+ -5884820390557805877360 6035490749445323626751726880246647718944552) 6035490749445323626745842059856089913067192)
    ((+ 7460751246334989389155810670253520607697015 5584266469305468) 7460751246334989389155810675837787077002483)))

($test-group abs
    ((cite (kernel-report 12 5 12))
     (require-standard-bindings abs)
     (number 13))
  ($eval-table
    ((abs -235715342147701644447120741111230366998324615875718910)
     235715342147701644447120741111230366998324615875718910)
  ;;
  ;; Inputs of the form -2^(k-1), where k is somewhere around machine
  ;; word size, may hit corner cases in implementations based on
  ;; 2-complement arithmetic.
  ;;
    ((abs -16384) 16384)
    ((abs -32768) 32768)
    ((abs -134217728) 134217728)
    ((abs -268435456) 268435456)
    ((abs -536870912) 536870912)
    ((abs -1073741824) 1073741824)
    ((abs -2147483648) 2147483648)
    ((abs -288230376151711744) 288230376151711744)
    ((abs -2305843009213693952) 2305843009213693952)
    ((abs -4611686018427387904) 4611686018427387904)
    ((abs -9223372036854775808) 9223372036854775808)
    ((abs -170141183460469231731687303715884105728) 170141183460469231731687303715884105728)))

($test-group min
    ((cite (kernel-report 12 5 13))
     (require-standard-bindings min)
     (number 1))
  ($eval-table
    ((min 124321342134 124321342135) 124321342134)))

($test-group max
    ((cite (kernel-report 12 5 13))
     (require-standard-bindings max)
     (number 1))
  ($eval-table
    ((max 124321342134 124321342135) 124321342135)))

($test-group lcm
    ((cite (kernel-report 12 5 14))
     (require-standard-bindings lcm)
     (plan normal-operation))
  ($test-group normal-operation
      ((number 10))
    ($eval-table
      ((lcm 7603496358 49139268750366) 603577638060745578)
      ((lcm 300604593405600 195403450) 106798499340548162400)
      ((lcm 215915435846349294425 591808784851061937465) 198442217465417075034732330776325)
      ((lcm 367978977047082763944 4655674584) 4047768747517910403384)
      ((lcm 5314803621758487787679 139892681574385731259592895) 6854741397144900831720051855)
      ((lcm 279700127396444293829364 559037948363243282825404) 63379212151536273448747110615669372)
      ((lcm 686582610704627405225688 395084573977009752) 1082740777081197418040909976)
      ((lcm 4173739500896634964296539435602278976
            171195585262353449510750771384652158379243894070013858855169699454164047730718889)
       10956517456790620768688049368617738136271609220480886966730860765066499054766008896)
      ((lcm 56990799607535686839083980352479712619192287905913
            6662374972591994417134771876665836006348233523)
       1260344101606906857961025484343832434503659326657183342918987354223)
      ((lcm 200684743041247141927276897776698697922354667801514177637261245763252874956223639078299432451605
            20448277034575168280257264706025635878858934038942907373078647645587429846630626455247156)
       181271749441615330654499223331487620722847750205730197552185664336081761212585746230260290984115433738344291313087051442517540))))

($test-group gcd
    ((cite (kernel-report 12 5 14))
     (require-standard-bindings gcd)
     (plan normal-operation))
  ($test-group normal-operation
      ((number 8))
    ($eval-table
      ((gcd                130888177992         296736589620432)        12947688)
      ((gcd           12356596947646692         170989118557452)         8628516)
      ((gcd          357660850204527947          77538158677518)             539)
      ((gcd       265048731409975961435       33981514182766336)       342423919)
      ((gcd       292945695677456778490      688247069056937465)    873643918685)
      ((gcd 419144775523264945495650467 56201707519325547155440) 548652343038707))
    ($eval-table
      ((gcd 115162856767114141163181350379866742535705
            817409996394625999388091197734093193745797600472883085)
        24037211176016904922702708025015)
      ((gcd 179406569181439942570546777608755013415272449577076296885647069681264641560950282085451191945800566236
            622913766210425877984057739081825500806919091082557077387879409090438764873768)
       138782212575286215455411228002061148376209503159749788381564))))
